@mixin gallery-item-left($force: false) {
    flex-basis: 100%;
    margin-left: auto;
    @if ($force) {margin-right: 0;}
    .img-block {
        margin-left: auto;
        @if ($force) {margin-right: 0;}
    }
}

@mixin gallery-item-right($force: false) {
    flex-basis: 100%;
    margin-right: auto;
    @if ($force) {margin-left: 0;}
    .img-block {
        margin-right: auto;
        @if ($force) {margin-left: 0;}
    }
}

@mixin gallery-item-center {
    flex-basis: 100%;
    margin-left: auto;
    margin-right: auto;

    .img-block {
        margin-left: auto;
        margin-right: auto;
    }
}

@mixin gallery-item-left-nth($a: 1, $b: 0, $force: false) {
    .gallery-item:nth-child(#{$a}n+#{$b}) {
        @include gallery-item-left($force);
    }
}

@mixin gallery-item-right-nth($a: 1, $b: 0, $force: false) {
    .gallery-item:nth-child(#{$a}n+#{$b}) {
        @include gallery-item-right($force);
    }
}

.gallery {
    @include fixed-container();
    @include content-padding();
    line-height: 1.25em;

    h5 {
        text-transform: uppercase;
        margin-bottom: 0.5em;
    }
    .gallery-collection{
        list-style: none;
        margin: 0;
        padding: 0;
        display: flex;
        flex-flow: wrap;
    }
    .gallery-item  {
        margin-top: 0.25em;
        margin-bottom: 0.25em;
        flex-grow: 0;
        flex-shrink: 1;
        box-sizing: border-box;
        padding: 0 0.25em;
        overflow: hidden;
    }

    .gallery-item .img-block,
    .gallery-item .img-wrapper {
        height: inherit;
    }

    .gallery-item .img-wrapper {
        cursor: pointer;
    }

    @include media-xl(){
        &.gallery-1 {
            .gallery-item {
                max-width: 100%;
            }
        }

        &,
        &.gallery-2 {
            .gallery-item {
                max-width: 50%;
            }
        }
    
        &.gallery-3 {
            .gallery-item {
                max-width: 33%;
            }
        }
    
        &.gallery-4 {
            .gallery-item {
                max-width: 25%;
            }
        }
    
        &.gallery-5 {
            .gallery-item {
                max-width: 20%;
            }
        }

        &.gallery-center {
            &.gallery-1 .gallery-item{
                @include gallery-item-center();
            }
    
            &.gallery-2 .gallery-item:nth-child(2n+1),
            &.gallery-3 .gallery-item:nth-child(3n+1),
            &.gallery-4 .gallery-item:nth-child(4n+1),
            &.gallery-5 .gallery-item:nth-child(5n+1) {
                @include gallery-item-left();
            }
        
            &.gallery-2 .gallery-item:nth-child(2n),
            &.gallery-3 .gallery-item:nth-child(3n),
            &.gallery-4 .gallery-item:nth-child(4n),
            &.gallery-5 .gallery-item:nth-child(5n),
            .gallery-item:last-child {
                @include gallery-item-right();
            }
        }

        &.gallery-left {
            &.gallery-1 .gallery-item:nth-child(1n),
            &.gallery-2 .gallery-item:nth-child(2n),
            &.gallery-3 .gallery-item:nth-child(3n),
            &.gallery-4 .gallery-item:nth-child(4n),
            &.gallery-5 .gallery-item:nth-child(5n) {
                @include gallery-item-right(true);
            }
        }

        &.gallery-right {
            &.gallery-1 .gallery-item:nth-child(1n),
            &.gallery-2 .gallery-item:nth-child(2n+1),
            &.gallery-3 .gallery-item:nth-child(3n+1),
            &.gallery-4 .gallery-item:nth-child(4n+1),
            &.gallery-5 .gallery-item:nth-child(5n+1) {
                @include gallery-item-left(true);
            }
        }
    }

    @include media-md(){
        &.gallery-5 {
            .gallery-item {
                max-width: 25%;
            }
        }

        &.gallery-center {
            &.gallery-5 {
                @include gallery-item-left-nth(4, 1);
                @include gallery-item-right-nth(4);
            }
        }

        &.gallery-left {
            &.gallery-5 {
                @include gallery-item-right-nth(4, 0, true);
            }
        }

        &.gallery-right {
            &.gallery-5 {
                @include gallery-item-left-nth(4, 1, true);
            }
        }
    }
    @include media-sm(){
        &.gallery-4,
        &.gallery-5 {
            .gallery-item {
                max-width: 33%;
            }
        }

        &.gallery-center {
            &.gallery-4,
            &.gallery-5 {
                @include gallery-item-left-nth(3, 1);
                @include gallery-item-right-nth(3);
            }
        }

        &.gallery-left {
            &.gallery-4,
            &.gallery-5 {
                @include gallery-item-right-nth(3, 0, true);
            }
        }

        &.gallery-right {
            &.gallery-4,
            &.gallery-5 {
                @include gallery-item-left-nth(3, 1, true);
            }
        }
    }
    @include media-xs(){
        &,
        &.gallery-2 {
            .gallery-item {
                max-width: 100%;
            }
        }

        &.gallery-3,
        &.gallery-4,
        &.gallery-5 {
            .gallery-item {
                max-width: 50%;
            }
        }

        &.gallery-center {
            &,
            &.gallery-2 {
                .gallery-item {
                    @include gallery-item-center();
                }
            }

            &.gallery-3,
            &.gallery-4,
            &.gallery-5 {
                @include gallery-item-left-nth(2, 1);
                @include gallery-item-right-nth(2);
            }
        }

        &.gallery-left {
            &,
            &.gallery-2,
            &.gallery-3,
            &.gallery-4,
            &.gallery-5 {
                @include gallery-item-right-nth(2, 0 true);
            }
        }

        &.gallery-right {
            &,
            &.gallery-2,
            &.gallery-3,
            &.gallery-4,
            &.gallery-5 {
                @include gallery-item-left-nth(2, 1, true);
            }
        }
    }
}

.layout .main-col .gallery {
    @include content-padding(1/2);
}

.full-overlay .gallery-full-size {
    position: absolute;
    opacity: 0;
    transition: opacity 0.3s ease-out;

    img {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        right: 0; left: 0;
        margin: 0 auto;
        max-width: 100%;
    }

    &.active {
        opacity: 1;
    }

    a.close-button{
        @include buttonify();
        @include btn-variant($color-white, $color-clear, $color-yellow, $color-clear);

        position: absolute;
        right: 0;
        top: 0;
        padding: 0;
    }
    a.close-button::before{
        content: "\2716";
    }

    @include media-xl {
        top: 5em; right: 5em; bottom: 5em; left: 5em;
        a.close-button {
            font-size: 1.5em;
        }
    }
    @include media-sm {
        top: 1em; right: 1em; bottom: 1em; left: 1em;
        a.close-button {
            top: 4.5em;
        }
    }
}